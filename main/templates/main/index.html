<!DOCTYPE html>
<html>
<head>
    <title>Translator</title>
</head>
<body>
    <header><h1>Translator</h1></header>

    <a class="btn btn-primary" href="/upload">Upload Code</a>
    <a class="btn btn-primary" href="/showcode">Show Code</a>

    <article id="mainArticle">
        <button onclick="startScript()">Start</button>
        <button onclick="stopScript()">Stop</button>
    </article>

    <aside>
        <button id="autoScrollButton" onclick="changeScroll()">AutoScroll</button>
        <button id="clear" onclick="clearArea()">Clear</button>
        <button onClick="window.location.reload();">Refresh Page</button>
    </aside>
    <article>
        <label for="log"></label><textarea id="log" readonly rows="15" cols="100"></textarea>
    </article>

    <a class="btn btn-primary" href="/video/1">Video 1</a>
    <a class="btn btn-primary" href="/video/2">Video 2</a>
    <a class="btn btn-primary" href="/video/3">Video 3</a>
    <a class="btn btn-primary" href="/video/4">Video 4</a>
    <a class="btn btn-primary" href="/video/5">Video 5</a>

    <script>
        const logContainer = document.getElementById('log');
        const socket = new WebSocket('ws://' + window.location.hostname + ':8100');
        const scrollButton = document.getElementById('autoScrollButton');
        let autoScroll = false;

        document.getElementById('mainArticle').className = 'formatForArticle';

        socket.onopen = function() {
            console.log('Connected to WebSocket');
        };

        socket.onclose = function() {
            console.log('Disconnected from WebSocket');
        };

        socket.onmessage = function(event) {
            let log = JSON.parse(event.data)['log'];
            if (log !== null) {
                for (const a in log) {
                    logContainer.value += '\n' + log[a];
                    if (autoScroll) logContainer.scrollTop = logContainer.scrollHeight;
                }
            }
        };

        function changeScroll() {
            autoScroll = !autoScroll;

            if (autoScroll) scrollButton.className = 'formatForButton';
            else scrollButton.className = 'scrollButton';
        }

        function clearArea() {
            logContainer.value = '';
        }

        function startScript() {
            fetch('/start/')
                .then(response => response.json())
                .then(data => alert(data.status));
        }

        function stopScript() {
            fetch('/stop/')
                .then(response => response.json())
                .then(data => alert(data.status));
        }
    </script>
    <style>
      .formatForButton {
        background-color:blue;
      }
      .formatForArticle {
          margin-top: 20px;
          margin-bottom: 20px;
      }
    </style>
</body>
</html>
